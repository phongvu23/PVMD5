<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MD5 Dice Analyzer</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #111;
    }

    @keyframes neonPulse {
        0%, 100% { box-shadow: 0 0 12px 2px var(--neon-color); }
        50% { box-shadow: 0 0 20px 6px var(--neon-color); }
    }

    @keyframes sparkle {
        0% { transform: translateY(0) scale(1); opacity: 1; }
        100% { transform: translateY(-60px) scale(0.5); opacity: 0; }
    }

    @keyframes pac-run {
        0% { transform: translateX(0); }
        100% { transform: translateX(100%); }
    }

    .md5-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 10px;
        border: 2px solid gold;
        border-radius: 20px;
        font-size: 20px;
        font-weight: bold;
        font-family: monospace;
        z-index: 9999;
        backdrop-filter: blur(5px);
        color: gold;
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: move;
        --neon-color: gold;
        animation: neonPulse 1.5s infinite ease-in-out;
        background: rgba(0, 0, 0, 0.6);
    }

    .sparkle {
        position: absolute;
        width: 8px;
        height: 8px;
        background: gold;
        border-radius: 50%;
        pointer-events: none;
        animation: sparkle 1s linear forwards;
    }

    .pacman {
        position: absolute;
        top: -25px;
        left: 0;
        font-size: 20px;
        animation: pac-run 3s linear infinite;
        pointer-events: none;
        user-select: none;
    }
  </style>
</head>
<body>
  <div class="md5-container" id="md5box">
    <div id="bubble">üé≤ ƒêang ch·ªù MD5...</div>
    <select id="partCount"></select>
  </div>

  <script>
    const diceMap = { 1: '‚öÄ', 2: '‚öÅ', 3: '‚öÇ', 4: '‚öÉ', 5: '‚öÑ', 6: '‚öÖ' };
    let lastCopied = '';
    const container = document.getElementById('md5box');
    const bubble = document.getElementById('bubble');
    const select = document.getElementById('partCount');

    for (let i = 3; i <= 18; i++) {
      const option = document.createElement('option');
      option.value = i;
      option.text = i;
      select.appendChild(option);
    }

    const soundT = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_3657b92910.mp3?filename=click-124467.mp3");
    const soundX = new Audio("https://cdn.pixabay.com/download/audio/2023/03/09/audio_0f0289c1b7.mp3?filename=correct-2-46134.mp3");
    const soundBao = new Audio("https://cdn.pixabay.com/download/audio/2022/10/03/audio_b1d8f4f854.mp3?filename=retro-arcade-tom-102502.mp3");

    function playSound(result) {
      if (result.includes("T√†i")) soundT.play();
      else if (result.includes("X·ªâu")) soundX.play();
      else if (result.includes("B√£o")) soundBao.play();
    }

    function parseMd5(md5, parts) {
      const partLength = Math.floor(md5.length / parts);
      const sliced = [];
      for (let i = 0; i < parts; i++) {
        sliced.push(md5.slice(i * partLength, (i + 1) * partLength));
      }
      const mapped = sliced.slice(0, 3).map(p => (parseInt(p, 16) % 6) + 1);
      const total = mapped.reduce((a, b) => a + b, 0);
      return { dice: mapped, total };
    }

    function analyze(total, dice) {
      const count = {};
      for (const n of dice) count[n] = (count[n] || 0) + 1;
      if (Object.values(count).includes(3)) return 'ü™ô B√£o';
      if (total <= 10) return 'üîå X·ªâu';
      return 'üî¥ T√†i';
    }

    function launchStars(count = 15) {
      for (let i = 0; i < count; i++) {
        const star = document.createElement('div');
        star.className = 'sparkle';
        star.style.left = `${Math.random() * 100}px`;
        star.style.top = `${Math.random() * 40}px`;
        star.style.background = `hsl(${Math.random() * 360}, 100%, 70%)`;
        container.appendChild(star);
        setTimeout(() => star.remove(), 1000);
      }
    }

    function showPacman() {
      const pacman = document.createElement('div');
      pacman.className = 'pacman';
      pacman.innerText = 'üü°üëªüü£üëªüîå';
      container.appendChild(pacman);
      setTimeout(() => pacman.remove(), 5000);
    }

    async function checkClipboard() {
      try {
        const text = await navigator.clipboard.readText();
        const parts = parseInt(select.value);
        if (text !== lastCopied && /^[a-fA-F0-9]{32}$/.test(text)) {
          lastCopied = text;
          const { dice, total } = parseMd5(text, parts);
          const result = analyze(total, dice);
          const icons = dice.map(n => diceMap[n]).join(' ');
          bubble.innerText = `${icons} - ${result}`;

          if (result.includes('X·ªâu')) {
            container.style.setProperty('--neon-color', '#00f0ff');
          } else if (result.includes('T√†i')) {
            container.style.setProperty('--neon-color', '#ff0055');
          } else {
            container.style.setProperty('--neon-color', 'gold');
          }

          launchStars(20);
          showPacman();
          playSound(result);
        }
      } catch (e) {
        console.error('Clipboard error:', e);
      }
    }

    select.addEventListener('change', () => {
      if (lastCopied && /^[a-fA-F0-9]{32}$/.test(lastCopied)) {
        const parts = parseInt(select.value);
        const { dice } = parseMd5(lastCopied, parts);
        bubble.innerText = dice.map(n => diceMap[n]).join(' ');
      }
    });

    setInterval(checkClipboard, 1500);

    // Drag support
    let offsetX, offsetY, isDragging = false;
    container.addEventListener('mousedown', function(e) {
        isDragging = true;
        offsetX = e.clientX - container.getBoundingClientRect().left;
        offsetY = e.clientY - container.getBoundingClientRect().top;
    });
    document.addEventListener('mousemove', function(e) {
        if (isDragging) {
            container.style.left = (e.clientX - offsetX) + 'px';
            container.style.top = (e.clientY - offsetY) + 'px';
            container.style.right = 'auto';
            container.style.bottom = 'auto';
        }
    });
    document.addEventListener('mouseup', function() {
        isDragging = false;
    });
  </script>
</body>
</html>
